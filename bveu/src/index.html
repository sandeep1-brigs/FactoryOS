<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, user-scalable=yes">
  <meta charset="UTF-8">

  <!-- Bootstrap and Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">
  <link rel="canonical" href="https://html5-templates.com/">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.structure.min.css">

  <!-- Meta Tags -->
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=The+Nautigal:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Moon+Dance&display=swap" rel="stylesheet">

  <!-- Application CSS -->
  <link rel="stylesheet" type="text/css" href="css/index.css">
  <link rel="stylesheet" type="text/css" href="css/digiveu.css">
  <link rel="stylesheet" type="text/css" href="css/ert.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" type="text/css" href="css/slider.css">
  <link rel="stylesheet" type="text/css" href="css/fonts.css">
  <link rel="stylesheet" type="text/css" href="css/material_sumbols.css">
  <link rel="stylesheet" type="text/css" href="css/pdfviewer.css">

  <title>BVeU Digi-Sign</title>
</head>
<body>

    <!-- Header Section -->
    <div id="headerSection" class="headerStyle">
        <div class="headerAreaStyle">
            <div class="headerLogoAreStyle">
                <div class="companyLogoAreaStyle" onclick="viewHome()">
                    <img class="companyLogoStyle" src="img/Responsive Logo -2.png" style="max-height: 60px;"/>
                </div>
            </div>

            <div class="userAreaStyle" onclick="viewLogin('menuProcess')">        
                <div id="networkSignal">
                    <img id="networkSignalIcon" style="width: 35px; height: 35px;" src="./img/no_network.png" />
                </div>
                <div id="userIcon" class="userProfileBtnAreaStyle">
                    <span class="material-symbols-outlined" style="font-size: 30px; margin: 4px;">person</span>
                    <div id="onlineDotOverlay" class="notificationOverlayClass"></div>
                </div>
                <div id="loggedUserName"></div>
            </div>
        </div>
        <div id="headerMenu"></div>
    </div>

    <!-- Download Progress Container -->
    <div id="downloadProgressContainer" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.7); z-index: 9999; flex-direction: column; justify-content: center; align-items: center; color: #fff; text-align: center; font-family: sans-serif;">
        <div id="progressMessage1" style="margin-bottom: 20px; font-size: 1.2rem;"></div>
        <div id="progressMessage2" style="margin-bottom: 20px; font-size: 1.2rem;"></div>
        <div style="width: 80%; max-width: 400px; background: #444; border-radius: 8px; overflow: hidden;">
            <div id="downloadProgressBar" style="width: 0%; height: 20px; background: #4caf50;"></div>
        </div>
    </div>
    
    <!-- Work Area Section -->
    <div id="workAreaSection" class="workAreaStyle">

        <div id="navDrawer" onclick="closeNavMenu()">
            <div id="navMenu"></div>
        </div>

        <!-- Loading Spinner -->
        <div onclick="closeLoadingSpinner()" id="loadingmessage" style="display:none;">
            <div id="spinnerImage"></div>
        </div>
        <div id="uploadingmessage" style="display:none;">
            <div id="uploaderMessageArea">
                <div style="text-align: center;">
                    <div id="uploaderImage"></div>
                    <div id="uploaderMessage">Please wait while file loads!</div>
                </div>
            </div>
        </div>

        <!-- Dialog Boxes -->
        <div id="dialogBox" onclick="closeDialogBox()" style="display:none; z-index:20;">
            <div id="dialogBoxCard">
                <div id="dialogText"></div>
                <div id="dialogOk">OK</div>
            </div>
        </div>

        <div id="confirmDialogBox" onclick="closeConfirmDialogBox()" style="display:none; z-index:20;">
            <div id="confirmDialogBoxCard">
                <div id="confirmDialogText"></div>
                <div style="display:flex; justify-content: space-around;">
                    <div id="confirmDialogYes">YES</div>
                    <div id="confirmDialogNo">NO</div>
                </div>
            </div>
        </div>

        <div class="fullScreenImage" id="img_fsarea"></div>

        <!-- Notification Area -->
        <div id="notificationArea" class="notificationAreaClass">
            <div class="userNotificationBox" id="notificationDetail">
                <div class="closeButton" onclick="closeNotificationDetail()"><i class="fas fa-times"></i></div>
                <div class="notificationAreaContent" id="notificationDetailContent"></div>
            </div>
            <div class="userNotificationBox" id="notificationList">
                <div class="closeButton" onclick="closeUserNotifications()"><i class="fas fa-times"></i></div>
                <div class="notificationAreaContent" id="notificationListContent"></div>
            </div>
        </div>

        <!-- Home Section -->
        <div id="homeSection" style="display:none; border:none; height: 100%; overflow: auto;">
            <div id="homeWindow" style="height: 100%;"></div>
        </div>

        <!-- Exit App Message -->
        <div id="exitAppMessage" style="display: none;">
            <div id="exitAppMessageArea">
                <div>Press back again to exit</div>
            </div>
        </div>

        <!-- Logout Section -->
        <div id="logoutSection" class="loginsection">
            <div id="logoutBackground" class="loginbackground"></div>
            <div id="logoutArea" class="loginarea">
                <div id="logoutWindow" class="loginwindow">
                    <div id="logoutIcon" class="loginicon">
                        <img src="./img/gear_user.png" class="dropShadowPng" style="width:80%; object-fit: contain;"/>
                    </div>

                    <div id="logoutForm" style="float:left; height:100%; width:75%;">
                        <div onclick="closeLogoutWindow()" style="float:right; padding:5px 15px; color:rgba(50,50,50,1.0); margin:10px; font-size:1.3em; line-height: 1.5;"><i class="fas fa-times"></i></div>
                        <p id="logoutUserMessage" style="padding:50px 20px 30px 20px; font-size:1.3em; line-height: 1.5; font-weight:normal; color:var(--secondary-blue);"></p>
                        <p style="padding:0px 20px 0px 20px; font-size:1.3em; line-height: 1.5; font-weight:bold; color:rgba(50,50,50,1.0);">Logout?</p>

                        <div id="logoutButton" style="width:fit-content; text-align:center; background:var(--secondary-orange); padding:10px 20px; color:var(--primary-white); margin: 15px auto 15px auto; border-radius:5px; font-size:1.3em; line-height:1.5; box-shadow:2px 2px 4px 0px rgba(0,0,0,0.2);">
                            Logout <i class="fas fa-sign-out-alt"></i>
                        </div>
                        <hr class="lightblack">
                        <div style="display:flex; margin:15px 0;">
                            <div id="continueButton2" style="text-align:left; font-size:1.3em; line-height:1.5; color:var(--secondary-blue); padding:5px 20px;">
                                Continue without logging out
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Section -->
        <div id="loginSection" class="loginsection">
            <div id="loginBackground" class="loginbackground"></div>
            <div id="loginArea" class="loginarea">
                <div id="loginWindow" class="loginwindow">
                    <div id="loginIcon" class="loginicon">
                        <img src="./img/gear_user.png" style="width:90%; object-fit: contain;"/>
                    </div>

                    <div id="loginForm" style="height:100%; width:75%; display: inline-grid;">
                        <input type="text" id="homeloginuserName" placeholder="User ID" style="width:80%; padding:5px 15px; color:rgb(50,50,50); background-color:transparent; border-style:none; margin:25px 20px 10px 20px; font-size:1.0em; line-height:1.5; border-bottom:1px solid rgba(0,0,0,0.1);">
                        <input type="password" id="homeloginpassword" placeholder="Password" style="width:80%; padding:5px 15px; color:rgb(50,50,50); background-color:transparent; border-style:none; margin:10px 20px; font-size:1em; line-height:1.5; border-bottom:1px solid rgba(0,0,0,0.1);"><br>

                        <button id="loginButton" style="text-align:center; background:var(--secondary-blue); padding:10px 30px; color:var(--primary-white); margin: 15px auto 20px auto; border-radius:5px; font-size:1.0em; line-height:1.5; border: none; box-shadow:2px 2px 4px 0px rgba(0,0,0,0.2);">
                            <i style="padding: 0 10px;" class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <hr class="lightblack">
                        <div style="display:flex; margin:10px 20px;">
                            <div id="continueButton" style="text-align:left; font-size:1em; line-height:1.5; color:var(--secondary-blue);">
                                Continue without logging in
                            </div>
                        </div>
                    </div>
                </div>

                <div id="signageStartMessage" style="padding:10px 10px; position: absolute; bottom: 20px; display:none; width: 100%; text-align: center;">
                    <div style="padding:10px 10px; display:none; width: fit-content; background-color:rgba(0,0,0,0.3); color:rgb(255, 255, 255); border-radius: 5px; display: flex; margin: 0px auto 0 auto; z-index:1001;">
                        <p id="signageMessage" style="padding:0 10px;">Signage will start in: </p>
                        <p id="SecondsUntilExpire"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Setup Login Section -->
        <div id="systemLoginSection" class="loginsection">
            <div id="systemLoginBackground" class="loginbackground"></div>
            <div id="systemLoginArea" class="loginarea">
                <div id="systemLoginWindow" class="loginwindow">
                    <div id="systemLoginIcon" class="loginicon">
                        <img src="./img/gear_user.png" style="width:90%; object-fit: contain;"/>
                    </div>

                    <form id="systemLoginForm" style="height:100%; width:75%; display: inline-grid;">
                        <input type="text" id="sysUserName" placeholder="Admin ID" style="width:80%; padding:0px 15px; color:rgba(50,50,50,1.0); background-color:transparent; border-style:none; margin:25px 20px 10px 20px; font-size:1.0em; line-height:1.5; border-bottom:1px solid rgba(0,0,0,0.1);"><br>
                        <input type="password" id="sysPassword" placeholder="Admin Password" style="width:80%; padding:0px 15px; color:rgba(50,50,50,1.0); background-color:transparent; border-style:none; margin:10px 20px; font-size:1em; line-height:1.5; border-bottom:1px solid rgba(0,0,0,0.1);"><br>

                        <a type="submit" id="systemLoginButton" style="text-align:center; background:var(--secondary-blue); padding:5px 30px; color:var(--primary-white); margin: 15px auto 20px auto; border-radius:5px; font-size:1.0em; line-height:1.5; box-shadow:2px 2px 4px 0px rgba(0,0,0,0.2);">
                            <i style="padding: 0 10px;" class="fas fa-sign-in-alt"></i> Login
                        </a>
                        <hr class="lightblack">
                        <div style="display:flex; margin:10px 20px;">
                            <div id="systemContinueButton" style="text-align:left; font-size:1em; line-height:1.5; color:var(--secondary-blue);">
                                I don't have Admin password!
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Device Info Section -->
        <div id="deviceInfoSection" style="display: none; overflow: auto;" onclick="closeDeviceInfo()">
            <div id="deviceInfoArea">
                <div id="deviceInfoTitle">About this device</div>
                <div id="deviceInfoBox"></div>
            </div>
        </div>

        <!-- Archive Share -->
        <div class="appSection" id="archiveShareSection" style="z-index: 4; display: none;"></div>

        <!-- Under Construction -->
        <div id="underConstructionSection" onclick="closeUnderContruction()" style="display: none; position: absolute; top: 0; bottom: 0; right: 0; left: 0; justify-content: center; align-items: center; background-color: rgba(0,0,0,0.2); z-index: 2;">
            <div id="underConstructionArea" style="margin: 20px; border-radius: 15px; padding: 10px; position: relative; max-width: 100%; max-height: 100%; background-color: rgb(255,255,255); box-shadow: 2px 2px 4px rgb(0 0 0 / 50%);">
                <img src="img/under-construction.png" style="max-width: 100%; max-height: 100%;"/>
            </div>
        </div>

        <!-- All Modules Section -->
        <div id="modulesSection" class="appSection" style="display: none; overflow: auto;">
            <div id="modulesArea" class="appArea">
                <div class="moduleHeader" id="modulesModuleHeader">
                    <div id="modulesPrevButton" class="moduleHeaderBtn" onclick="backBtnHandle()"><span class="material-symbols-outlined" style="font-size: 30px;">arrow_back</span></div>
                    <div id="moduleTitle" class="moduleNameClass"></div>
                    <div id="modulesCloseButton" class="moduleHeaderBtn" onclick="exitModules()"><span class="material-symbols-outlined" style="font-size: 30px;">close</span></div>
                </div>
                <div id="modulesBox" class="appBox">
                    <div class="appFullPage" id="modulesMenuArea"></div>
                    <div class="lightBkClass" id="modulesListArea" style="overflow: auto;"><div class="appFullPage" id="modulesListBox" style="padding-bottom: 30px;"></div></div>
                    <div class="appFullPage" id="modulesDisplayArea"></div>
                </div>
            </div>
        </div>

        <!-- ERT Section -->
        <div id="ertSection" class="appSection" style="display: none; overflow: auto;">
            <div id="ertworkarea" style="height: 100%;">
                <div id="ertCloseBtn" class="videoControlButton" onclick="exitErt()"> <i class="fas fa-times"></i></div>
                <div id="ertViewerArea" style="height: 100%;"></div>
            </div>
        </div>

    </div>

    <!-- System Section -->
    <div id="systemSection" style="display:none; overflow: auto;">
        <div id="systemArea">
            <div id="systemWindow"></div>
            <div id="qrCodeWindow" onclick="closeQRCode()" style="display:none; align-items:center; justify-content:center; position:absolute; top:0; left:0; bottom:0; right: 0; background-color: rgba(0,0,0,0.5); z-index:14;">
                <div style="padding:40px; height: max-content; background-color: rgba(255,255,255,1.0); box-shadow:0px -4px 8px 0px rgba(0,0,0,0.2), 0px 10px 25px 10px rgba(0,0,0,0.3);">
                    <div id="qrcode"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Us Section -->
    <div id="contactUsSection" class="appSection" style="display:none; overflow: auto;">
        <div id="contactUsArea" Style="text-align: center;">
            <div class="moduleHeader" style="position: unset; box-shadow: none; z-index: unset;" id="contactusModuleHeader">
                <div></div>
                <div class="moduleNameClass">CONTACT US</div>
                <div id="contactUsCloseButton" class="moduleHeaderBtn" onclick="closeContactUs()"><span><i class="fas fa-times"></i></span></div>
            </div>
            <div class="moduleDescriptionClass" style="margin-top: 20px;">Please fill the form below. Our executive will get back to you soon.</div>
            <div id="contactUsWindow"></div>
        </div>
    </div>

    <!-- Help Section -->
    <div id="helpSection" class="appSection" style="display:none; overflow: auto;">
        <div id="HelpArea" class="appArea">
            <div class="moduleHeader" id="helpModuleHeader">
                <div id="helpPrevButton" class="moduleHeaderBtn" onclick="backHelpHandle()"><span><i class="fas fa-arrow-left"></i></span></div>
                <div class="moduleNameClass">HELP</div>
                <div id="helpCloseButton" class="moduleHeaderBtn" onclick="exitHelp()"><span><i class="fas fa-times"></i></span></div>
            </div>
            <div id="helpBox" class="appBox">
                <div class="appFullPage" id="helpListArea"></div>
                <div class="appFullPage" id="helpMenuArea"></div>
                <div class="appFullPage" id="helpDetailArea"></div>
            </div>
        </div>
    </div>

    <!-- DigiVeu Section -->
    <div id="bannerSection">
        <div id="signageworkarea">
            <div id="signagePage"></div>
            <div id="viewerCloseBtn" class="videoControlButton" onclick="exitToHome()"> <i class="fas fa-times"></i></div>
            <div id="muteButton" class="videoControlButton" onclick="muteVolume()"> <i class="fas fa-volume-off"></i></div>
            <div id="pauseButton" class="videoControlButton" style="font-size: 2.0em;" onclick="pauseVideo()"><i class="fas fa-pause"></i></div>
            <input id="volControl" type="range" min="0" max="100" step="1" oninput="SetVolume(this.value)" onchange="SetVolume(this.value)"></input>
        </div>
        <div id="mydiv" style="display: none;"></div>
    </div>

    <div style="width: 100%; position: absolute; top: 500px; z-index: 3; display: none;" id="qrreader"></div>

    <!-- Data Log Area -->
    <div id="dataLogArea" style="display: none; z-index: 15; position: absolute; top: 80px; left: 20px; overflow: auto; background-color: white; height: calc(100% - 160px); padding: 25px; width: calc(100% - 40px); border-radius: 10px; color: var(--primary-blue); box-shadow: rgba(0, 0, 0, 0.5) 3px 3px 6px;">
        <button id="closeDataLogBtn" class="kmkioskBtnStyle" style="position: absolute; right: 10px; top: 10px;" onclick="closeDataLogArea()">CLOSE</button>
        <div class="titleFontClass" style="width: 100%; text-align: center;">DEBUG LOG</div>
        <div style="width:100%; height:100%; overflow: auto;">
            <div id="datalogBox"></div>
        </div>
    </div>

    <!-- Footer Section -->
    <div id="footerSection">
        <div id="footerMenu"></div>
        <div id="appVersion" style="position: absolute; right: 10px; bottom: 5px; font-size: 8px;"></div>
    </div>

    <!-- ==================== SCRIPTS ==================== -->
    
    <!-- Third-party CDN Libraries (Load First - Non-module) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    
    
    <!-- jsPDF and html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- WebSocket Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    
    <!-- Crypto Components -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/core-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/hmac-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha256-min.js"></script>
    
    <!-- Sortable -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sortable/1.15.0/Sortable.min.js"></script>

    <!-- Capacitor Core (Load before your modules) -->
    <script type="module">
      // Capacitor initialization and configuration
      import { Capacitor } from '@capacitor/core';
      import { App } from '@capacitor/app';
      
      // Make Capacitor available globally
      window.capacitor = Capacitor;
      
      // Platform detection
      window.isNative = Capacitor.isNativePlatform();
      window.platform = Capacitor.getPlatform();
      
      console.log('Capacitor initialized:', {
        platform: window.platform,
        isNative: window.isNative
      });
      
      // Handle Android back button
      if (window.platform === 'android') {
        App.addListener('backButton', ({canGoBack}) => {
          // Your custom back button logic here
          if (window.handleBackButton) {
            window.handleBackButton(canGoBack);
          } else if (!canGoBack) {
            App.exitApp();
          } else {
            window.history.back();
          }
        });
      }
      
      // Handle app state changes
      App.addListener('appStateChange', ({ isActive }) => {
        console.log('App state changed. Is active?', isActive);
        if (window.onAppStateChange) {
          window.onAppStateChange(isActive);
        }
      });
      
      // Handle URL open events (deep linking)
      App.addListener('appUrlOpen', (event) => {
        console.log('App opened with URL:', event.url);
        if (window.onAppUrlOpen) {
          window.onAppUrlOpen(event.url);
        }
      });
    </script>

    <!-- Application Modules (Load in dependency order) -->
    
    <!-- Core utilities and globals first -->
    <script type="module" src="js/capacitor-welcome.js"></script>
    <script type="module" src="js/globals.js"></script>
    <script type="module" src="js/utility.js"></script>
    <!-- <script type="module" src="js/log.js"></script> -->
    
    <!-- File operations and settings -->
    <script type="module" src="js/fileoperation.js"></script>
    <script type="module" src="js/settings.js"></script>
    
    <!-- Authentication -->
    <script type="module" src="js/auth.js"></script>
    
    <!-- Content and list management -->
    <script type="module" src="js/content.js"></script>
    <script type="module" src="js/list.js"></script>
    
    <!-- UI Components -->
    <script type="module" src="js/pdfviewer.js"></script>
    <script type="module" src="js/slider.js"></script>
    
    <!-- Feature modules -->
    <script type="module" src="js/digiveu.js"></script>
    <script type="module" src="js/ert.js"></script>
    <script type="module" src="js/solutions.js"></script>
    <script type="module" src="js/knowledgemate.js"></script>
    <script type="module" src="js/assetmate.js"></script>
    <script type="module" src="js/sitemate.js"></script>
    <script type="module" src="js/visitmate.js"></script>
    <script type="module" src="js/lotomate.js"></script>
    
    <!-- Supporting features -->
    <script type="module" src="js/contactus.js"></script>
    <script type="module" src="js/help.js"></script>
    <script type="module" src="js/notification.js"></script>
    <!-- <script type="module" src="js/qrcode.js"></script> -->
    <script type="module" src="js/fingerprint.js"></script>
    <!-- <script type="module" src="js/clicker.js"></script> -->
    <script type="module" src="js/pipemarking.js"></script>
    <script type="module" src="js/kmkiosk.js"></script>
    <script type="module" src="js/miniapp.js"></script>
    
    <!-- WebSocket (load after core modules) -->
    <script type="module" src="js/websocket.js"></script>

    <!-- Address bar hiding for mobile browsers -->
    <script>
      window.addEventListener('load', function(e) {
        setTimeout(function() { window.scrollTo(0, 1); }, 1);
      }, false);
    </script>

</body>
</html>